{% extends "base.html" %}
{% block content %}
<div class="lecture">
  <h1>–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ PostgreSQL: CASE, LIKE, DISTINCT, UNION, –¥–∞—Ç—ã –∏ —Ç–µ—Å—Ç—ã</h1>

  <p class="muted">
    –í —ç—Ç–æ–π –ª–µ–∫—Ü–∏–∏ ‚Äî –Ω–∞–±–æ—Ä –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –æ—á–µ–Ω—å —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.
    –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞: <strong>–¥–∞–Ω–Ω—ã–µ ‚Üí –∑–∞–ø—Ä–æ—Å ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç</strong>.
  </p>

  <hr>

  <h2>CASE</h2>
  <p>
    <code>CASE</code> ‚Äî —ç—Ç–æ —É—Å–ª–æ–≤–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –≤ SQL. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—á–∏—Å–ª—è—Ç—å –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É—Å–ª–æ–≤–∏—è–º.
    –ë—ã–≤–∞–µ—Ç –¥–≤–∞ –≤–∏–¥–∞:
  </p>
  <ul>
    <li><strong>searched CASE</strong>: <code>CASE WHEN —É—Å–ª–æ–≤–∏–µ THEN ...</code> ‚Äî —Å–∞–º—ã–π —á–∞—Å—Ç—ã–π</li>
    <li><strong>simple CASE</strong>: <code>CASE expr WHEN value THEN ...</code> ‚Äî –∫–æ–≥–¥–∞ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏</li>
  </ul>

  <h3>–ü—Ä–∏–º–µ—Ä 1 ‚Äî searched CASE: –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Å—É–º–º–µ</h3>

  <p class="muted">–î–∞–Ω–Ω—ã–µ:</p>
  <div class="result">
    <div class="result__title">orders</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>customer</th><th>total</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>Alice</td><td>45</td></tr>
          <tr><td>2</td><td>Bob</td><td>120</td></tr>
          <tr><td>3</td><td>Carol</td><td>260</td></tr>
          <tr><td>4</td><td>Dave</td><td>120</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <p class="muted">–ó–∞–ø—Ä–æ—Å:</p>
  <pre class="sql"><code>SELECT
  id,
  customer,
  total,
  CASE
    WHEN total &lt; 100 THEN 'small'
    WHEN total &lt; 200 THEN 'medium'
    ELSE 'large'
  END AS bucket
FROM orders
ORDER BY id;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç:</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>customer</th><th>total</th><th>bucket</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>Alice</td><td>45</td><td>small</td></tr>
          <tr><td>2</td><td>Bob</td><td>120</td><td>medium</td></tr>
          <tr><td>3</td><td>Carol</td><td>260</td><td>large</td></tr>
          <tr><td>4</td><td>Dave</td><td>120</td><td>medium</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <h3>–ü—Ä–∏–º–µ—Ä 2 ‚Äî simple CASE: –º–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞</h3>

  <p class="muted">–î–∞–Ω–Ω—ã–µ:</p>
  <div class="result">
    <div class="result__title">tasks</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>status</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>new</td></tr>
          <tr><td>2</td><td>in_progress</td></tr>
          <tr><td>3</td><td>done</td></tr>
          <tr><td>4</td><td>blocked</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <p class="muted">–ó–∞–ø—Ä–æ—Å:</p>
  <pre class="sql"><code>SELECT
  id,
  status,
  CASE status
    WHEN 'new' THEN '–ù–æ–≤–∞—è'
    WHEN 'in_progress' THEN '–í —Ä–∞–±–æ—Ç–µ'
    WHEN 'done' THEN '–ì–æ—Ç–æ–≤–æ'
    ELSE '–î—Ä—É–≥–æ–µ'
  END AS status_ru
FROM tasks
ORDER BY id;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç:</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>status</th><th>status_ru</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>new</td><td>–ù–æ–≤–∞—è</td></tr>
          <tr><td>2</td><td>in_progress</td><td>–í —Ä–∞–±–æ—Ç–µ</td></tr>
          <tr><td>3</td><td>done</td><td>–ì–æ—Ç–æ–≤–æ</td></tr>
          <tr><td>4</td><td>blocked</td><td>–î—Ä—É–≥–æ–µ</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="callout callout--tip">
    <div class="callout__title">üí° CASE —á–∞—Å—Ç–æ –∫–æ–º–±–∏–Ω–∏—Ä—É—é—Ç —Å –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏</div>
    <p class="muted">
      –ù–∞–ø—Ä–∏–º–µ—Ä, ‚Äú–ø–æ—Å—á–∏—Ç–∞—Ç—å —Å–∫–æ–ª—å–∫–æ done/new‚Äù –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑
      <code>SUM(CASE WHEN ... THEN 1 ELSE 0 END)</code>
      –∏–ª–∏ —á–µ—Ä–µ–∑ <code>FILTER</code (–≤ PostgreSQL —ç—Ç–æ —á–∞—â–µ –ø—Ä–æ—â–µ).
    </p>
  </div>

  <hr>

  <h2>LIKE –∏ ILIKE</h2>
  <p>
    <code>LIKE</code> ‚Äî —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–º —à–∞–±–ª–æ–Ω–æ–º.
  </p>
  <ul>
    <li><code>%</code> ‚Äî –ª—é–±–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏–º–≤–æ–ª–æ–≤</li>
    <li><code>_</code> ‚Äî —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª</li>
    <li><code>LIKE</code> –≤ PostgreSQL –æ–±—ã—á–Ω–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É</li>
    <li><code>ILIKE</code> ‚Äî –Ω–µ—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É (PostgreSQL-—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞)</li>
  </ul>

  <h3>–ü—Ä–∏–º–µ—Ä 3 ‚Äî LIKE: –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 'Al'</h3>

  <p class="muted">–î–∞–Ω–Ω—ã–µ:</p>
  <div class="result">
    <div class="result__title">users</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>name</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>Alice</td></tr>
          <tr><td>2</td><td>Alex</td></tr>
          <tr><td>3</td><td>Bob</td></tr>
          <tr><td>4</td><td>ALBERT</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <p class="muted">–ó–∞–ø—Ä–æ—Å:</p>
  <pre class="sql"><code>SELECT id, name
FROM users
WHERE name LIKE 'Al%'
ORDER BY id;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç (LIKE —Ä–µ–≥–∏—Å—Ç—Ä–æ–∑–∞–≤–∏—Å–∏–º):</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>name</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>Alice</td></tr>
          <tr><td>2</td><td>Alex</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <h3>–ü—Ä–∏–º–µ—Ä 4 ‚Äî ILIKE: –±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞</h3>

  <p class="muted">–ó–∞–ø—Ä–æ—Å:</p>
  <pre class="sql"><code>SELECT id, name
FROM users
WHERE name ILIKE 'al%'
ORDER BY id;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç (ILIKE –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä):</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>name</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>Alice</td></tr>
          <tr><td>2</td><td>Alex</td></tr>
          <tr><td>4</td><td>ALBERT</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <h3>–ü—Ä–∏–º–µ—Ä 5 ‚Äî LIKE —Å '_' (—Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª)</h3>

  <p class="muted">–î–∞–Ω–Ω—ã–µ:</p>
  <div class="result">
    <div class="result__title">codes</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>code</th></tr></thead>
        <tbody>
          <tr><td>A1</td></tr>
          <tr><td>A2</td></tr>
          <tr><td>AA</td></tr>
          <tr><td>A10</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <p class="muted">–ó–∞–ø—Ä–æ—Å:</p>
  <pre class="sql"><code>SELECT code
FROM codes
WHERE code LIKE 'A_'
ORDER BY code;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç (–¥–ª–∏–Ω–∞ 2 —Å–∏–º–≤–æ–ª–∞, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ A):</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>code</th></tr></thead>
        <tbody>
          <tr><td>A1</td></tr>
          <tr><td>A2</td></tr>
          <tr><td>AA</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="callout callout--warning">
    <div class="callout__title">‚ö† –ü—Ä–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</div>
    <p class="muted">
      <code>LIKE '%text%'</code> –æ–±—ã—á–Ω–æ –Ω–µ –º–æ–∂–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å btree-–∏–Ω–¥–µ–∫—Å.
      –í —Ä–µ–∞–ª—å–Ω–æ–º PostgreSQL –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –ø–æ–¥—Å—Ç—Ä–æ–∫–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç trigram-–∏–Ω–¥–µ–∫—Å—ã (<code>pg_trgm</code>),
      –Ω–æ –≤ —É—á–µ–±–Ω–æ–º —Ç—Ä–µ–Ω–∞–∂—ë—Ä–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –±–∞–∑–æ–≤—É—é –º–µ—Ö–∞–Ω–∏–∫—É.
    </p>
  </div>

  <hr>

  <h2>DISTINCT</h2>
  <p>
    <code>DISTINCT</code> —É–±–∏—Ä–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã —Å—Ç—Ä–æ–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ.
    –ú–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∫ –æ–¥–Ω–æ–π –∫–æ–ª–æ–Ω–∫–µ –∏–ª–∏ –∫ –Ω–∞–±–æ—Ä—É –∫–æ–ª–æ–Ω–æ–∫.
  </p>

  <h3>–ü—Ä–∏–º–µ—Ä 6 ‚Äî DISTINCT –ø–æ –æ–¥–Ω–æ–π –∫–æ–ª–æ–Ω–∫–µ</h3>

  <p class="muted">–î–∞–Ω–Ω—ã–µ:</p>
  <div class="result">
    <div class="result__title">visits</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>user_id</th><th>page</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>/</td></tr>
          <tr><td>1</td><td>/</td></tr>
          <tr><td>1</td><td>/pricing</td></tr>
          <tr><td>2</td><td>/</td></tr>
          <tr><td>2</td><td>/pricing</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <p class="muted">–ó–∞–ø—Ä–æ—Å:</p>
  <pre class="sql"><code>SELECT DISTINCT page
FROM visits
ORDER BY page;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã):</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>page</th></tr></thead>
        <tbody>
          <tr><td>/</td></tr>
          <tr><td>/pricing</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <h3>–ü—Ä–∏–º–µ—Ä 7 ‚Äî DISTINCT –ø–æ –ø–∞—Ä–µ –∫–æ–ª–æ–Ω–æ–∫</h3>

  <p class="muted">–ó–∞–ø—Ä–æ—Å:</p>
  <pre class="sql"><code>SELECT DISTINCT user_id, page
FROM visits
ORDER BY user_id, page;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–∞—Ä—ã user_id + page):</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>user_id</th><th>page</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>/</td></tr>
          <tr><td>1</td><td>/pricing</td></tr>
          <tr><td>2</td><td>/</td></tr>
          <tr><td>2</td><td>/pricing</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="callout callout--note">
    <div class="callout__title">–û—Ç–¥–µ–ª—å–Ω–æ: DISTINCT ON (PostgreSQL)</div>
    <p class="muted">
      –í PostgreSQL –µ—Å—Ç—å –º–æ—â–Ω–∞—è —Ñ–∏—á–∞ <code>DISTINCT ON (col)</code>, —á—Ç–æ–±—ã –≤–∑—è—Ç—å ‚Äú–ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É‚Äù –ø–æ –≥—Ä—É–ø–ø–µ.
      –ï—ë –ª—É—á—à–µ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –ª–µ–∫—Ü–∏—é ‚Äî —Ç–∞–º –≤–∞–∂–Ω–æ –ø–æ–Ω—è—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å <code>ORDER BY</code>.
    </p>
  </div>

  <hr>

  <h2>UNION –∏ UNION ALL</h2>
  <p>
    <code>UNION</code> –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–≤—É—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ <strong>–∏ —É–±–∏—Ä–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã</strong> (–∫–∞–∫ DISTINCT).
    <code>UNION ALL</code> –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã <strong>–±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è</strong> –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (–æ–±—ã—á–Ω–æ –±—ã—Å—Ç—Ä–µ–µ).
  </p>

  <div class="callout callout--note">
    <div class="callout__title">–ü—Ä–∞–≤–∏–ª–∞ UNION</div>
    <ul class="mistakes">
      <li>–í –æ–±–æ–∏—Ö SELECT –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–Ω–æ–∫</li>
      <li>–¢–∏–ø—ã –∫–æ–ª–æ–Ω–æ–∫ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º—ã</li>
      <li>–ò–º–µ–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫ –±–µ—Ä—É—Ç—Å—è –∏–∑ –ø–µ—Ä–≤–æ–≥–æ SELECT</li>
    </ul>
  </div>

  <h3>–ü—Ä–∏–º–µ—Ä 8 ‚Äî UNION (–¥—É–±–ª–∏–∫–∞—Ç—ã —É–±–∏—Ä–∞—é—Ç—Å—è)</h3>

  <p class="muted">–î–∞–Ω–Ω—ã–µ:</p>
  <div class="result">
    <div class="result__title">emails_marketing</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>email</th></tr></thead>
        <tbody>
          <tr><td>a@example.com</td></tr>
          <tr><td>b@example.com</td></tr>
          <tr><td>c@example.com</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="result">
    <div class="result__title">emails_support</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>email</th></tr></thead>
        <tbody>
          <tr><td>b@example.com</td></tr>
          <tr><td>c@example.com</td></tr>
          <tr><td>d@example.com</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <p class="muted">–ó–∞–ø—Ä–æ—Å:</p>
  <pre class="sql"><code>SELECT email FROM emails_marketing
UNION
SELECT email FROM emails_support
ORDER BY email;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ email):</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>email</th></tr></thead>
        <tbody>
          <tr><td>a@example.com</td></tr>
          <tr><td>b@example.com</td></tr>
          <tr><td>c@example.com</td></tr>
          <tr><td>d@example.com</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <h3>–ü—Ä–∏–º–µ—Ä 9 ‚Äî UNION ALL (–¥—É–±–ª–∏–∫–∞—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è)</h3>

  <p class="muted">–ó–∞–ø—Ä–æ—Å:</p>
  <pre class="sql"><code>SELECT email FROM emails_marketing
UNION ALL
SELECT email FROM emails_support
ORDER BY email;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç (–¥—É–±–ª–∏–∫–∞—Ç—ã –Ω–µ —É–±–∏—Ä–∞—é—Ç—Å—è):</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>email</th></tr></thead>
        <tbody>
          <tr><td>a@example.com</td></tr>
          <tr><td>b@example.com</td></tr>
          <tr><td>b@example.com</td></tr>
          <tr><td>c@example.com</td></tr>
          <tr><td>c@example.com</td></tr>
          <tr><td>d@example.com</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <hr>

  <h2>–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç –∏ –≤—Ä–µ–º–µ–Ω–∏ (PostgreSQL)</h2>
  <p>
    –í PostgreSQL –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—Ç/–≤—Ä–µ–º–µ–Ω–∏ —á–∞—â–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç <code>to_char</code>.
    –î–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —á–∞—Å—Ç–µ–π –¥–∞—Ç—ã ‚Äî <code>EXTRACT</code>.
    –î–ª—è –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º ‚Äî <code>date_trunc</code>.
  </p>

  <h3>–ü—Ä–∏–º–µ—Ä 10 ‚Äî to_char: —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã</h3>

  <p class="muted">–î–∞–Ω–Ω—ã–µ:</p>
  <div class="result">
    <div class="result__title">events</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>created_at</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>2026-01-02 10:15:00</td></tr>
          <tr><td>2</td><td>2026-01-02 18:05:00</td></tr>
          <tr><td>3</td><td>2026-02-10 09:00:00</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <p class="muted">–ó–∞–ø—Ä–æ—Å:</p>
  <pre class="sql"><code>SELECT
  id,
  created_at,
  to_char(created_at, 'YYYY-MM-DD') AS day,
  to_char(created_at, 'DD Mon YYYY, HH24:MI') AS pretty
FROM events
ORDER BY id;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç:</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>created_at</th><th>day</th><th>pretty</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>2026-01-02 10:15:00</td><td>2026-01-02</td><td>02 Jan 2026, 10:15</td></tr>
          <tr><td>2</td><td>2026-01-02 18:05:00</td><td>2026-01-02</td><td>02 Jan 2026, 18:05</td></tr>
          <tr><td>3</td><td>2026-02-10 09:00:00</td><td>2026-02-10</td><td>10 Feb 2026, 09:00</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <h3>–ü—Ä–∏–º–µ—Ä 11 ‚Äî EXTRACT: —á–∞—Å—Ç–∏ –¥–∞—Ç—ã (–≥–æ–¥/–º–µ—Å—è—Ü/–¥–µ–Ω—å)</h3>

  <p class="muted">–ó–∞–ø—Ä–æ—Å:</p>
  <pre class="sql"><code>SELECT
  id,
  created_at,
  EXTRACT(YEAR  FROM created_at) AS year,
  EXTRACT(MONTH FROM created_at) AS month,
  EXTRACT(DAY   FROM created_at) AS day
FROM events
ORDER BY id;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç:</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>created_at</th><th>year</th><th>month</th><th>day</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>2026-01-02 10:15:00</td><td>2026</td><td>1</td><td>2</td></tr>
          <tr><td>2</td><td>2026-01-02 18:05:00</td><td>2026</td><td>1</td><td>2</td></tr>
          <tr><td>3</td><td>2026-02-10 09:00:00</td><td>2026</td><td>2</td><td>10</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <h3>–ü—Ä–∏–º–µ—Ä 12 ‚Äî date_trunc: –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –º–µ—Å—è—Ü—É</h3>

  <p class="muted">–ó–∞–ø—Ä–æ—Å:</p>
  <pre class="sql"><code>SELECT
  date_trunc('month', created_at) AS month_start,
  COUNT(*) AS events_count
FROM events
GROUP BY month_start
ORDER BY month_start;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç:</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>month_start</th><th>events_count</th></tr></thead>
        <tbody>
          <tr><td>2026-01-01 00:00:00</td><td>2</td></tr>
          <tr><td>2026-02-01 00:00:00</td><td>1</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <hr>

  <h2>–¢–µ—Å—Ç—ã –≤ PostgreSQL: IS NULL, EXISTS, IN, BETWEEN</h2>
  <p>
    ‚Äú–¢–µ—Å—Ç—ã‚Äù ‚Äî —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —É—Å–ª–æ–≤–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ <code>WHERE</code>:
    <code>IS NULL</code>, <code>EXISTS</code>, <code>IN</code>, <code>BETWEEN</code>.
  </p>

  <h3>–ü—Ä–∏–º–µ—Ä 13 ‚Äî IS NULL / IS NOT NULL</h3>

  <p class="muted">–î–∞–Ω–Ω—ã–µ:</p>
  <div class="result">
    <div class="result__title">users</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>email</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>a@example.com</td></tr>
          <tr><td>2</td><td>NULL</td></tr>
          <tr><td>3</td><td>c@example.com</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <p class="muted">–ó–∞–ø—Ä–æ—Å (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ email):</p>
  <pre class="sql"><code>SELECT id, email
FROM users
WHERE email IS NULL;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç:</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>email</th></tr></thead>
        <tbody>
          <tr><td>2</td><td>NULL</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <h3>–ü—Ä–∏–º–µ—Ä 14 ‚Äî IN (—Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π)</h3>

  <p class="muted">–î–∞–Ω–Ω—ã–µ:</p>
  <div class="result">
    <div class="result__title">products</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>name</th><th>category</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>Keyboard</td><td>electronics</td></tr>
          <tr><td>2</td><td>Chair</td><td>furniture</td></tr>
          <tr><td>3</td><td>Mouse</td><td>electronics</td></tr>
          <tr><td>4</td><td>Cup</td><td>kitchen</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <p class="muted">–ó–∞–ø—Ä–æ—Å (–¥–≤–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏):</p>
  <pre class="sql"><code>SELECT id, name, category
FROM products
WHERE category IN ('electronics', 'kitchen')
ORDER BY id;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç:</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>name</th><th>category</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>Keyboard</td><td>electronics</td></tr>
          <tr><td>3</td><td>Mouse</td><td>electronics</td></tr>
          <tr><td>4</td><td>Cup</td><td>kitchen</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <h3>–ü—Ä–∏–º–µ—Ä 15 ‚Äî BETWEEN (–≤–∫–ª—é—á–∞—è –≥—Ä–∞–Ω–∏—Ü—ã)</h3>

  <p class="muted">–î–∞–Ω–Ω—ã–µ:</p>
  <div class="result">
    <div class="result__title">orders</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>total</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>45</td></tr>
          <tr><td>2</td><td>120</td></tr>
          <tr><td>3</td><td>260</td></tr>
          <tr><td>4</td><td>200</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <p class="muted">–ó–∞–ø—Ä–æ—Å (–æ—Ç 100 –¥–æ 200 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ):</p>
  <pre class="sql"><code>SELECT id, total
FROM orders
WHERE total BETWEEN 100 AND 200
ORDER BY id;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç:</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>total</th></tr></thead>
        <tbody>
          <tr><td>2</td><td>120</td></tr>
          <tr><td>4</td><td>200</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <h3>–ü—Ä–∏–º–µ—Ä 16 ‚Äî EXISTS (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è)</h3>

  <p class="muted">–î–∞–Ω–Ω—ã–µ:</p>
  <div class="result">
    <div class="result__title">users</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>name</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>Alice</td></tr>
          <tr><td>2</td><td>Bob</td></tr>
          <tr><td>3</td><td>Carol</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="result">
    <div class="result__title">orders</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>user_id</th></tr></thead>
        <tbody>
          <tr><td>10</td><td>1</td></tr>
          <tr><td>11</td><td>1</td></tr>
          <tr><td>12</td><td>2</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <p class="muted">–ó–∞–ø—Ä–æ—Å (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∑–∞–∫–∞–∑):</p>
  <pre class="sql"><code>SELECT u.id, u.name
FROM users u
WHERE EXISTS (
  SELECT 1
  FROM orders o
  WHERE o.user_id = u.id
)
ORDER BY u.id;</code></pre>

  <div class="result">
    <div class="result__title">–†–µ–∑—É–ª—å—Ç–∞—Ç:</div>
    <div class="table-wrap">
      <table>
        <thead><tr><th>id</th><th>name</th></tr></thead>
        <tbody>
          <tr><td>1</td><td>Alice</td></tr>
          <tr><td>2</td><td>Bob</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <hr>

  <h2>–ò—Ç–æ–≥–æ</h2>
  <ul>
    <li><code>CASE</code> ‚Äî —É—Å–ª–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, –º–∞–ø–ø–∏–Ω–≥).</li>
    <li><code>LIKE</code>/<code>ILIKE</code> ‚Äî –ø–æ–∏—Å–∫ –ø–æ —à–∞–±–ª–æ–Ω—É, <code>ILIKE</code> ‚Äî –±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞ (Postgres).</li>
    <li><code>DISTINCT</code> ‚Äî —É–±—Ä–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã —Å—Ç—Ä–æ–∫.</li>
    <li><code>UNION</code> —É–±–∏—Ä–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã, <code>UNION ALL</code> ‚Äî –Ω–µ—Ç (–æ–±—ã—á–Ω–æ –±—ã—Å—Ç—Ä–µ–µ).</li>
    <li><code>to_char</code>, <code>EXTRACT</code>, <code>date_trunc</code> ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–æ–π/–≤—Ä–µ–º–µ–Ω–µ–º.</li>
    <li><code>IS NULL</code>, <code>IN</code>, <code>BETWEEN</code>, <code>EXISTS</code> ‚Äî –±–∞–∑–æ–≤—ã–µ ‚Äú—Ç–µ—Å—Ç—ã‚Äù –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.</li>
  </ul>
</div>
{% endblock %}
